<!--
 * @license
 *
 * Copyright © 2025 Regione Piemonte
 *
 * Licensed under the EUPL, Version 1.2 or – as soon they will be
 * approved by the European Commission - subsequent versions of the
 * EUPL (the "Licence");
 *
 * You may not use this work except in compliance with the Licence.
 * You may obtain a copy of the Licence at:
 *
 * https://interoperable-europe.ec.europa.eu/collection/eupl/eupl-text-eupl-12
 * or
 * https://opensource.org/license/EUPL-1.2
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the Licence is distributed on an "AS IS" basis,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the Licence for the specific language governing permissions and
 * limitations under the Licence.
 -->

<mat-card>
  <mat-card-header>
    <mat-card-title>
      <!-- Titolo -->
        <h5 class="mb-5">Incontro Pre-Accoglienza</h5>
    </mat-card-title>
  </mat-card-header>
  <mat-card-content class="container-fluid">
    <div class="row" *ngIf="incontro">

      <div class="col-3 mb-4"><Strong>Denominazione:</Strong></div>
        <div class="col-3">{{incontro.denominazione}}</div>
      <div class="col-3"><Strong>Sede:</Strong></div>
        <div class="col-3">{{incontro.luogoIncontro?.denominazione}} - {{incontro.luogoIncontro?.indirizzo}}</div>

      <div class="col-3 mb-4"><Strong>Data:</Strong></div>
        <div class="col-3">{{incontro.dataIncontro | date:"dd/MM/yyyy"}}</div>
      <div class="col-3"><Strong>Ora</Strong></div>
        <div class="col-3">{{incontro.dataIncontro | date:"HH:mm"}}</div>

      <div class="col-3 mb-4"><Strong>Note:</Strong></div>
        <div class="col-3">{{incontro.note}}</div>

      <div class="col-12 d-flex" *ngIf="!isStampa && superUser">
        <div class="" *ngIf="canCambiareIncontro">
          <button mat-button
                class="btn btn--primary"
                aria-label="Modifica Incontro"
                (click)="onModificaIncontroAssociato()">CAMBIA INCONTRO
          </button>
        </div>
        <div class="ms-auto">
          <button mat-button
                class="btn btn--primary"
                aria-label="Modifica"
                (click)="onModifica()">{{canModify?'MODIFICA DATI INCONTRO':'VISUALIZZA'}}
          </button>
        </div>

      </div>
    </div>
  </mat-card-content>
</mat-card>

<ng-template #sceltaIncontro>

  <!-- Title -->
  <h2 mat-dialog-title>Scelta un incontro di preaccoglienza</h2>

  <!-- Content -->
  <section mat-dialog-content style="max-height: 70vh">
    <form [formGroup]="formIncontro" >

      <!-- Area territoriale -->
      <div class="row py-3">
        <div class="col-12" >
          <mat-form-field class="col-12" appearance="legacy">
            <mat-label>Area territoriale</mat-label>
            <mat-select (selectionChange)="onScheltaAreaTerritoriale($event)" formControlName="areaTerritoriale">
              <mat-option *ngFor="let a of areeTerritoriali" [value]="a.codiceAreaTerritoriale">
                {{a.descrizioneAreaTerritoriale}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
      <!-- Incontro preaccoglienza -->
      <div class="row py-3">
        <div class="col-12" >
          <mat-form-field class="col-12" appearance="legacy">
            <mat-label>Incontro preaccoglienza</mat-label>
            <mat-select (selectionChange)="onSceltaIncontroPreaccoglienza($event.value)" formControlName="incontroPreaccoglienza">
              <mat-option>--</mat-option>
              <mat-option
                *ngFor="let incontro of incontroPreaccoglienzaList"
                [value]="incontro.id"
                [matTooltip]="incontro.id + ' - ' + incontro.denominazione + ' - ' + (incontro.dataIncontro | date: 'dd/MM/yyyy HH:mm')">
                {{incontro.id}} - {{incontro.denominazione}} - {{incontro.dataIncontro | date: 'dd/MM/yyyy HH:mm'}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
    </form>
  </section>
  <!-- Actions -->
  <div mat-dialog-actions class="d-flex justify-content-between">
    <div>
      <button mat-dialog-close
              mat-raised-button
              class="btn"
              aria-label="annulla"
              (click)="formIncontro.reset()">
        ANNULLA
      </button>
    </div>

    <div>
      <button mat-dialog-close
              mat-raised-button
              [disabled]="!formIncontro.valid"
              class="btn btn--primary"
              aria-label="conferma scelta tutor"
              (click)="modificaIncontroPreaccoglienza()">
        CONFERMA
      </button>
    </div>
  </div>

</ng-template>


