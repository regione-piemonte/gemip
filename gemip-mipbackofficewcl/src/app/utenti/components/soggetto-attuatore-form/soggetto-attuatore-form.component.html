<!--
 * @license
 *
 * Copyright © 2025 Regione Piemonte
 *
 * Licensed under the EUPL, Version 1.2 or – as soon they will be
 * approved by the European Commission - subsequent versions of the
 * EUPL (the "Licence");
 *
 * You may not use this work except in compliance with the Licence.
 * You may obtain a copy of the Licence at:
 *
 * https://interoperable-europe.ec.europa.eu/collection/eupl/eupl-text-eupl-12
 * or
 * https://opensource.org/license/EUPL-1.2
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the Licence is distributed on an "AS IS" basis,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the Licence for the specific language governing permissions and
 * limitations under the Licence.
 -->

<div class="row not-stampa">
  <button class="col-auto d-flex justify-content-start" mat-button aria-label="Indietro" (click)="tornaIndietro()"><mat-icon role="presentation">arrow_back</mat-icon></button>
  <button class="col-auto ms-auto d-flex justify-content-end" mat-button (click)="selectedTab = 2" aria-label="Stampa"><mat-icon role="presentation">print</mat-icon></button>
</div>


<mat-tab-group class="mt-3"
              [selectedIndex]="selectedTab"
              (selectedIndexChange)="selectedTab = $event;">

<!-- Handle dati identificativi -->
<mat-tab label="Soggetto">
 <form [formGroup]="form">
  <mat-card class="myDivToPrint">
  <mat-card-header>
    <mat-card-title>
      <!-- Titolo -->
      <h5 class="mb-5">Dati soggetto</h5>
    </mat-card-title>
  </mat-card-header>
  <mat-card-content class="container-fluid">
  <div class="row">

    <div class="col-3 mb-3"><strong>Gruppo/Codice Operatore</strong></div>
    <div class="col-3">{{soggetto.gruppoOperatore! +soggetto.codOperatore}}</div>

    <div class="col-3 mb-3"><strong>Denominazione</strong></div>
    <div class="col-3">{{soggetto.denominazione}}</div>


    <ng-container *ngIf="isAttuatore">
    <div class="col-3 mb-3"><strong>Area territoriale</strong></div>
    <div class="col-3 mb-3"> {{soggetto.codiceAreaTerritoriale?.descrizioneAreaTerritoriale}}</div>
    </ng-container>


    <div class="row">
      <!-- Telefono -->
      <div class="col-6">
        <mat-form-field appearance="legacy">
          <mat-label>Numero di telefono</mat-label>
          <input matInput formControlName="telefono">
          <mat-error>
            <app-control-messages
              [control]="form.controls['telefono'] | castFromControl"></app-control-messages>
          </mat-error>
        </mat-form-field>
      </div>


      <!-- Email -->
      <div class="col-6">
        <mat-form-field class="col-6" appearance="legacy">
          <mat-label>indirizzo email</mat-label>
          <input matInput formControlName="email">
          <mat-error>
            <app-control-messages [control]="form.controls['email'] | castFromControl"></app-control-messages>
          </mat-error>
        </mat-form-field>
      </div>

    </div>

  </div>
  </mat-card-content>

  </mat-card>
  </form>

  <div class="btn--group-card" *ngIf="canModify">
    <div class="ms-auto p-2">
      <button mat-button
              class="btn btn--primary"
              (click)="aggiornaDati()">SALVA</button>
    </div>
  </div>

</mat-tab>

<mat-tab label="Operatori">
<mat-card class="myDivToPrint">
<app-table
  [rowData]="rowData"
  [tableSettings]="tableSettings"
  [columnList]="columnList">
</app-table>
</mat-card>
</mat-tab>

<mat-tab label="Stampa">
  <mat-card class="myDivToPrint">
  <mat-card-header>
    <mat-card-title>
      <!-- Titolo -->
      <h5 class="mb-5">Dati soggetto</h5>
    </mat-card-title>
  </mat-card-header>
  <mat-card-content class="container-fluid mb-4">
  <div class="row">

    <div class="col-3 mb-3"><strong>Gruppo/Codice Operatore</strong></div>
    <div class="col-3">{{soggetto.gruppoOperatore! +soggetto.codOperatore}}</div>

    <div class="col-3 mb-3"><strong>Denominazione</strong></div>
    <div class="col-3">{{soggetto.denominazione}}</div>

    <div class="col-3 mb-3"><strong>Email</strong></div>
    <div class="col-3">{{soggetto.email}}</div>

    <div class="col-3 mb-3"><strong>Area territoriale</strong></div>
    <div class="col-3">{{soggetto.codiceAreaTerritoriale?.descrizioneAreaTerritoriale}}</div>


  </div>
  </mat-card-content>

  <app-table
    [rowData]="rowData"
    [tableSettings]="tableSettings"
    [columnList]="columnList"
    [isStampa]="true">
  </app-table>
</mat-card>
<div class="btn--group-card">
  <div class="ms-auto p-2">
    <button mat-button
            class="btn btn--primary"
            aria-label="Salva"
            (click)="print()">STAMPA</button>
  </div>
</div>
</mat-tab>

</mat-tab-group>


